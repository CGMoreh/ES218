<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bivariate analysis</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-39623718-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-39623718-2');
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="libs\style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Introduction
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Week01.html">Course Introduction</a>
    </li>
    <li>
      <a href="The_R_environment.html">The R and RStudio environments</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data Manipulation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 02</li>
    <li>
      <a href="Week02a.html">Data types</a>
    </li>
    <li>
      <a href="Week02b.html">Reading and writing data files</a>
    </li>
    <li>
      <a href="Week02c.html">Working with date objects</a>
    </li>
    <li>
      <a href="Week02d.html">Exploring and cleaning dataframes using base functions</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 03</li>
    <li>
      <a href="Week03a.html">Manipulating dataframes with dplyr</a>
    </li>
    <li>
      <a href="Week03d.html">Working with string objects</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 04</li>
    <li>
      <a href="Week03ab_groupby.html">Grouping and summarizing tables</a>
    </li>
    <li>
      <a href="Week03b.html">Tidying/reshaping tables using tidyr</a>
    </li>
    <li>
      <a href="Week03c.html">Joining data tables</a>
    </li>
    <li>
      <a href="Week03ab_examples.html">Example of data manipulation workflows</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Plots
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 05</li>
    <li>
      <a href="Week04a.html">The base plotting environment</a>
    </li>
    <li>
      <a href="Week04b.html">The lattice plotting environment</a>
    </li>
    <li>
      <a href="Week04c.html">The ggplot plotting environment</a>
    </li>
    <li>
      <a href="Week04d.html">Manipulating colors in R</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Univariate
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 06</li>
    <li>
      <a href="Week05a.html">Visualizing univariate data</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 07</li>
    <li>
      <a href="Week05b.html">Comparing univariate data distributions</a>
    </li>
    <li>
      <a href="Week06a.html">Theoretical Q-Q plot</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 08</li>
    <li>
      <a href="Week07a.html">Fits and residuals</a>
    </li>
    <li>
      <a href="Week07b.html">Spread-location plot</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 09</li>
    <li>
      <a href="Week08a.html">Re-expressing data</a>
    </li>
    <li>
      <a href="Week08b.html">Letter value summaries</a>
    </li>
    <li>
      <a href="Week08c.html">The Two R’s of EDA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Bivariate
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 10</li>
    <li>
      <a href="Week09a.html">Bivariate analysis</a>
    </li>
    <li>
      <a href="Week09b.html">Resistant lines</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 11</li>
    <li>
      <a href="Week10a.html">The third R of EDA: Residuals</a>
    </li>
    <li>
      <a href="Week10b.html">Detecting discontinuities in the data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Two-way tables
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 12</li>
    <li>
      <a href="Week11a.html">Median polish/Mean polish</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Misc
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Misc01.html">R markdown documents</a>
    </li>
    <li class="dropdown-header">Week 13</li>
    <li>
      <a href="Week12a.html">Creating maps in R</a>
    </li>
    <li class="dropdown-header">Connecting to relational databases</li>
  </ul>
</li>
<li>
  <a href="Data.html">Datasets</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<link href="https://fonts.googleapis.com/css?family=Open+Sans%7CSource+Code+Pro" rel="stylesheet">

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Bivariate analysis</h1>

</div>


<hr />
<table class="table" style="width: auto !important; ">
<thead>
<tr>
<th style="text-align:left;color: #555555 !important;background-color: #dddddd !important;text-align: center;border: 1px solid white !important;
             font-family: &#39;Source Code Pro&#39;, &#39;Open Sans&#39;;
             padding:1px !important;
             padding-left:4px !important;
             padding-right:4px !important;
             font-size: 0.8em;
             border-radius: 5px;">
ggplot2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;color: darkred !important;background-color: #FAE8E8 !important;text-align: center;border: 1px solid white;
             font-family: &#39;Open Sans&#39;, Arial;
             padding:1px !important;
             padding-left:4px !important;
             padding-right:4px !important;
             font-size: 0.8em;
             border-radius: 5px;">
3.2.1
</td>
</tr>
</tbody>
</table>
<hr />
<p><em> This material is intended to supplement <strong>pages 87 to 105</strong> of <strong>Cleveland’s book</strong>. </em></p>
<p>Bivariate data are datasets that store two variables measured from a same observation (e.g. wind speed <strong>and</strong> temperature at a single location). This differs from univariate data where only one variable is measured for each observation (e.g. temperature at a single location).</p>
<div id="scatter-plot" class="section level1">
<h1>Scatter plot</h1>
<p>A scatter plot is a popular visualization tool used to compare values between two variables. Sometimes one variable is deemed <em>dependent</em> on another variable; the latter being the <em>independent</em> variable. Cleveland refers to the former as the <em>response</em> and the latter as the <em>factor</em>. The dependent variable is usually plotted on the y-axis and the independent variable is usually plotted on the x-axis. Other times, one does not seek a dependent-independent relationship between variables but is simply interested in studying the relationship between them.</p>
<p>A scatter plot can be generated using the base plotting environment as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;http://mgimond.github.io/ES218/Data/ganglion.csv&quot;</span>)</a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">plot</span>(cp.ratio <span class="op">~</span><span class="st"> </span>area, <span class="dt">dat =</span> df)</a></code></pre></div>
<p><img src="Week09a_files/figure-html/unnamed-chunk-3-1.png" width="240" /></p>
<p>Or, using <code>ggplot2</code>, as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> area, <span class="dt">y =</span> cp.ratio)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="Week09a_files/figure-html/unnamed-chunk-4-1.png" width="240" /></p>
<p>The data represent, on the y-axis, the ratio between the ganglion cell density of a cat’s central retina to that of its peripheral density (variable <code>cp.ratio</code>) and, on the x-axis, the cat’s retina surface area (<code>area</code>) during its early development (ranging from 35 to 62 days of gestation).</p>
</div>
<div id="fitting-the-data" class="section level1">
<h1>Fitting the data</h1>
<p>Scatter plots are a good first start in visualizing the data, but this is sometimes not enough. Our eyes need “guidance” to help perceive patterns. Another visual aid involves <strong>fitting</strong> the data with a line.</p>
<div id="parametric-fit" class="section level2">
<h2>Parametric fit</h2>
<div id="fitting-a-straight-line" class="section level3">
<h3>Fitting a straight line</h3>
<p>A straight line is the simplest fit one can make to bivariate data. A popular method for fitting a straight line is the least-squares method. We’ll use R’s <code>lm()</code> function which provides us with a slope and intercept for the best fit line.</p>
<p>In the base plotting environment, we can do the following:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">M &lt;-<span class="st"> </span><span class="kw">lm</span>(cp.ratio <span class="op">~</span><span class="st"> </span>area, <span class="dt">dat =</span> df)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">plot</span>(cp.ratio <span class="op">~</span><span class="st"> </span>area, <span class="dt">dat =</span> df)</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw">abline</span>(M, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="Week09a_files/figure-html/unnamed-chunk-5-1.png" width="240" /></p>
<p>In the <code>ggplot2</code> plotting environment, we can make use of the <code>stat_smooth</code> function to generate the regression line.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> area, <span class="dt">y =</span> cp.ratio)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="st">             </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span><span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="Week09a_files/figure-html/unnamed-chunk-6-1.png" width="240" /></p>
<p>The <code>se=FALSE</code> option prevents R from drawing a confidence envelope around the regression line.</p>
<p>The straight line is a first order polynomial with two parameters, <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, that define an equation that best describes the relationship between the two variables:</p>
<p><span class="math display">\[
CP\ Ratio = a + b (Area)
\]</span></p>
<p>where <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> can be extracted from the model <code>M</code> as follows:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">coef</span>(M)</a></code></pre></div>
<pre><code>(Intercept)        area 
 0.01399056  0.10733436 </code></pre>
<p>Thus <span class="math inline">\(a\)</span> =0.014 and <span class="math inline">\(b\)</span> = 0.11.</p>
</div>
<div id="fitting-a-2nd-order-polynomial" class="section level3">
<h3>Fitting a 2<sup>nd</sup> order polynomial</h3>
<p>A second order polynomial is a three parameter function (<span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span>) whose equation <span class="math inline">\(y = a + bx + cx^2\)</span> defines the curve that best fits the data. We define such a relationship in R using the formula <code>cp.ratio ~ area + I(area^2)</code>. Our new <code>lm</code> expression and resulting coefficients follow:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">M2 &lt;-<span class="st"> </span><span class="kw">lm</span>(cp.ratio <span class="op">~</span><span class="st">  </span>area <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(area<span class="op">^</span><span class="dv">2</span>) , <span class="dt">dat =</span> df)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">coef</span>(M2)</a></code></pre></div>
<pre><code>  (Intercept)          area     I(area^2) 
 2.8684792029 -0.0118691702  0.0008393243 </code></pre>
<p>The quadratic fit is thus,</p>
<p><span class="math display">\[
y = 2.87 - 0.012 x + 0.000839 x^2
\]</span></p>
<p>We cannot use <code>abline</code> to plot the predicted 2nd order polynomial curve since <code>abline</code> only draws straight lines. We will need to construct the line manually using the <code>predict</code> and <code>lines</code> functions.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">plot</span>(cp.ratio <span class="op">~</span><span class="st"> </span>area, <span class="dt">dat=</span>df)</a>
<a class="sourceLine" id="cb9-2" title="2">x.pred &lt;-<span class="st"> </span><span class="kw">data.frame</span>( <span class="dt">area =</span> <span class="kw">seq</span>(<span class="kw">min</span>(df<span class="op">$</span>area), <span class="kw">max</span>(df<span class="op">$</span>area), <span class="dt">length.out =</span> <span class="dv">50</span>) )</a>
<a class="sourceLine" id="cb9-3" title="3">y.pred &lt;-<span class="st"> </span><span class="kw">predict</span>(M2, x.pred)</a>
<a class="sourceLine" id="cb9-4" title="4"><span class="kw">lines</span>(x.pred<span class="op">$</span>area, y.pred, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="Week09a_files/figure-html/unnamed-chunk-9-1.png" width="240" /></p>
<p>To do this in <code>ggplot2</code> simply pass the formula as an argument to <code>stat_smooth</code>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> area, <span class="dt">y =</span> cp.ratio)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st">  </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>) )</a></code></pre></div>
<p><img src="Week09a_files/figure-html/unnamed-chunk-10-1.png" width="240" /></p>
</div>
</div>
<div id="non-parametric-fits" class="section level2">
<h2>Non-parametric fits</h2>
<div id="loess" class="section level3">
<h3>LOESS</h3>
<p>A more flexible curve fitting option is the LOESS curve (short for <strong>local regression</strong>). Unlike the parametric approach to fitting a curve, the loess does <strong>not</strong> impose a structure on the data. The loess curve fits small segments of a regression lines across the range of x-values, then links the mid-points of these regression lines to generate the smooth curve. The range of x-values that contribute to each localized regression lines is defined by the <span class="math inline">\(\alpha\)</span> parameter which usually ranges from 0.2 to 1. The larger the <span class="math inline">\(\alpha\)</span> value, the smoother the curve. The other parameter that defines a LOESS curve is <span class="math inline">\(\lambda\)</span>: it defines the polynomial order of the localized regression line. This is usually set to 1 (though <code>ggplot2</code>’s implementation of the loess defaults to a 2<sup>nd</sup> order polynomial).</p>
<p>The LOESS fit can be computed using the <code>loess()</code> function. It takes as arguments <code>span</code> (<span class="math inline">\(\alpha\)</span>), and <code>degree</code> (<span class="math inline">\(\lambda\)</span>).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co"># Fit loess function</span></a>
<a class="sourceLine" id="cb11-2" title="2">lo &lt;-<span class="st"> </span><span class="kw">loess</span>(cp.ratio <span class="op">~</span><span class="st"> </span>area, df, <span class="dt">span =</span> <span class="fl">0.5</span>, <span class="dt">degree =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-3" title="3"></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="co"># Predict loess values for a range of x-values</span></a>
<a class="sourceLine" id="cb11-5" title="5">lo.x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(df<span class="op">$</span>area), <span class="kw">max</span>(df<span class="op">$</span>area), <span class="dt">length.out =</span> <span class="dv">50</span>)</a>
<a class="sourceLine" id="cb11-6" title="6">lo.y &lt;-<span class="st"> </span><span class="kw">predict</span>(lo, lo.x)</a></code></pre></div>
<p>The predicted loess curve can be added using the <code>lines</code> function.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">plot</span>(cp.ratio <span class="op">~</span><span class="st"> </span>area, <span class="dt">dat =</span> df)</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw">lines</span>(lo.x, lo.y, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="Week09a_files/figure-html/unnamed-chunk-12-1.png" width="240" /></p>
<p>In <code>ggplot2</code> simply pass the <code>method="loess"</code> parameter to the <code>stat_smooth</code> function.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> area, <span class="dt">y =</span> cp.ratio)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="st">             </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">span =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<p>However, <code>ggplot</code> (up to version 2.1, at least) defaults to a second degree loess (i.e. the small regression line elements that define the loess are defined by a 2<sup>nd</sup> order polynomial and not a 1<sup>st</sup> order polynomial). If a first order polynomial (<code>degree=1</code>) is desired, you need to include an argument list in the form of <code>method.args=list(degree=1)</code> to the <code>stat_smooth</code> function.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> area, <span class="dt">y =</span> cp.ratio)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="st">             </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">span =</span> <span class="fl">0.5</span>, </a>
<a class="sourceLine" id="cb14-3" title="3">                         <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">degree =</span> <span class="dv">1</span>) )</a></code></pre></div>
<p><img src="Week09a_files/figure-html/unnamed-chunk-14-1.png" width="240" /></p>
</div>
</div>
</div>
<div id="residuals" class="section level1">
<h1>Residuals</h1>
<p>Fitting the data with a line is just the first step in EDA. Your next step should be to explore the residuals. The residuals are the distances (along the y-axis) between the observed points and the fitted line. The closer the points to the line (i.e. the smaller the residuals) the better the fit.</p>
<p>The residuals can be computed using the <code>residuals()</code> function. It takes as argument the model object. For example, to extract the residuals from the linear model <code>M</code> computed earlier type,</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">residuals</span>(M)</a></code></pre></div>
<pre><code>         1          2          3          4          5          6          7          8          9         10 
 1.3596154  1.3146525  0.5267426 -0.1133131 -0.1421694  0.3998247 -1.2188692 -2.0509148 -1.8622085 -0.1704418 
        11         12         13         14 
-0.5788861  0.4484394 -1.0727624  3.1602905 </code></pre>
<div id="residual-dependence-plot" class="section level2">
<h2>Residual-dependence plot</h2>
<p>We’ll create a <strong>residual dependence plot</strong> to plot the residuals as a function of the x-values. We’ll do this using <code>ggplot</code> so that we can also fit a loess curve to help discern any pattern in the residuals (the <code>ggplot</code> function makes it easier to add a loess fit than the traditional plotting environment).</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">df<span class="op">$</span>residuals &lt;-<span class="st"> </span><span class="kw">residuals</span>(M)</a>
<a class="sourceLine" id="cb17-2" title="2"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> area, <span class="dt">y =</span> residuals)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="st">             </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">span =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb17-4" title="4">                         <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">degree =</span> <span class="dv">1</span>) )</a></code></pre></div>
<p><img src="Week09a_files/figure-html/unnamed-chunk-16-1.png" width="240" /></p>
<p>We are interested in identifying any pattern in the residuals. If the model does a good job in fitting the data, the points should be uniformly distributed across the plot and the loess fit should approximate a horizontal line. With the linear model <code>M</code>, we observe a convex pattern in the residuals suggesting that the linear model is not a good fit. We say that the residuals show <em>dependence</em> on the x values.</p>
<p>Next, we’ll look at the residuals from the second order polynomial model <code>M2</code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">df<span class="op">$</span>residuals2 &lt;-<span class="st"> </span><span class="kw">residuals</span>(M2)</a>
<a class="sourceLine" id="cb18-2" title="2"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> area, <span class="dt">y =</span> residuals2)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb18-3" title="3"><span class="st">               </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">span =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb18-4" title="4">                           <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">degree =</span> <span class="dv">1</span>) )</a></code></pre></div>
<p><img src="Week09a_files/figure-html/unnamed-chunk-17-1.png" width="240" /></p>
<p>There is no indication of dependency between the residual and the <code>area</code> values. The second order polynomial is an improvement over the first order polynomial. Let’s look at the loess model.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">df<span class="op">$</span>residuals3 &lt;-<span class="st"> </span><span class="kw">residuals</span>(lo)</a>
<a class="sourceLine" id="cb19-2" title="2"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> area, <span class="dt">y =</span> residuals3)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="st">               </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">span =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb19-4" title="4">                           <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">degree =</span> <span class="dv">1</span>) )</a></code></pre></div>
<p><img src="Week09a_files/figure-html/unnamed-chunk-18-1.png" width="240" /></p>
<p>The loess model also seems to do a good job in smoothing out any overall pattern in the data.</p>
<p>You may ask <em>“if the loess model does such a good job in fitting the data, why bother with polynomial fits?”</em> If you are seeking to generate a predictive model that explains the relationship between the y and x variables, then a mathematically tractable model (like a polynomial model) should be sought. If the interest is simply in identifying a pattern in the data, then a loess fit is a good choice.</p>
<p>Next we will look for homogeneity in the residuals.</p>
</div>
<div id="spread-location-plot" class="section level2">
<h2>Spread-location plot</h2>
<p>The <code>M2</code> and <code>lo</code> models do a good job in eliminating any dependence between residual and x-value. Next, we will check that the residuals do not show a dependence with <em>fitted</em> y-values. This is analogous to univariate analysis where we checked if residuals increased or decreased with increasing medians across factors. Here we will compare residuals to the fitted <code>cp.ratio</code> values (think of the fitted line as representing a <em>level</em> across different segments along the x-axis). We’ll generate a spread-level plot of model <code>M2</code>’s residuals (note that in the realm of regression analysis, such plot is often referred to as a <strong>scale-location</strong> plot). We’ll also add a loess curve to help visualize any patterns in the plot (this reproduces fig 3.14 in Cleveland’s book).</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">sl2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>( <span class="dt">std.res =</span> <span class="kw">sqrt</span>(<span class="kw">abs</span>(<span class="kw">residuals</span>(M2))), </a>
<a class="sourceLine" id="cb20-2" title="2">                   <span class="dt">fit     =</span> <span class="kw">predict</span>(M2))</a>
<a class="sourceLine" id="cb20-3" title="3"></a>
<a class="sourceLine" id="cb20-4" title="4"><span class="kw">ggplot</span>(sl2, <span class="kw">aes</span>(<span class="dt">x =</span> fit, <span class="dt">y  =</span>std.res)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb20-5" title="5"><span class="st">              </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">span =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb20-6" title="6">                          <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">degree =</span> <span class="dv">1</span>) )</a></code></pre></div>
<p><img src="Week09a_files/figure-html/unnamed-chunk-19-1.png" width="240" /></p>
<p>The function <code>predict()</code> extracts the y-values from the fitted model <code>M2</code> and is plotted along the x-axis. It’s clear from this plot that the residuals are not homogeneous; they increase as a function of increasing <em>fitted</em> CP ratio. The “bend” observed in the loess curve is most likely due to a single point at the far (right) end of the fitted range. Given that we have a small batch of numbers, a loess can be easily influenced by an outlier. We may want to increase the span.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">ggplot</span>(sl2, <span class="kw">aes</span>(<span class="dt">x =</span> fit, <span class="dt">y =</span> std.res)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="st">              </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">span =</span> <span class="fl">1.5</span>, </a>
<a class="sourceLine" id="cb21-3" title="3">                          <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">degree =</span> <span class="dv">1</span>) )</a></code></pre></div>
<p><img src="Week09a_files/figure-html/unnamed-chunk-20-1.png" width="240" /></p>
<p>The point’s influence is reduced enough to convince us that the observed monotonic increase is real (Note that we would observe this monotone spread with our loess model as well). At this point, we should look into re-expressing the data.</p>
</div>
<div id="checking-residuals-for-normality" class="section level2">
<h2>Checking residuals for normality</h2>
<p>If you are interested in conducting a hypothesis test (i.e. addressing the question <em>“is the slope significantly different from 0”</em>) you will likely want to check the residuals for normality since this is an assumption made when computing a confidence interval and a p-value. We’ll make use of <code>geom_qq</code> and <code>geom_qq_line</code> to compare the residuals to a normal distribution.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">sample =</span> residuals2)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_qq</span>(<span class="dt">distribution =</span> qnorm) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="st">  </span><span class="kw">geom_qq_line</span>(<span class="dt">distribution =</span> qnorm, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<p><img src="Week09a_files/figure-html/unnamed-chunk-21-1.png" width="240" /></p>
<p>Here, the residuals seem to stray a little from a normal distribution.</p>
</div>
</div>
<div id="re-expressing-the-data" class="section level1">
<h1>Re-expressing the data</h1>
<p>The monotone spread can be problematic if we are to characterize the spread of <code>cp.ratio</code> as being the same across all values of <code>area</code>. To remedy this, we can re-express the <code>cp.ratio</code> values. Ratios are good candidates for log transformation. We will therefore fit a new linear model to the data after transforming the y-value.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">df.log &lt;-<span class="st"> </span><span class="kw">data.frame</span>( <span class="dt">area =</span> df<span class="op">$</span>area, <span class="dt">cp.ratio.log =</span> <span class="kw">log</span>(df<span class="op">$</span>cp.ratio))</a>
<a class="sourceLine" id="cb23-2" title="2">M3     &lt;-<span class="st"> </span><span class="kw">lm</span>(cp.ratio.log <span class="op">~</span><span class="st"> </span>area, <span class="dt">dat =</span> df.log)</a></code></pre></div>
<p>Next, let’s plot the transformed data and add the fitted line.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">ggplot</span>(df.log, <span class="kw">aes</span>(<span class="dt">x =</span> area, <span class="dt">y =</span> cp.ratio.log)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb24-2" title="2"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="Week09a_files/figure-html/unnamed-chunk-23-1.png" width="240" /></p>
<p>At first glance, the log transformation seems to have done a good job at straightening the batch of values. Next, let’s look at the residual dependence plot.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">df.log<span class="op">$</span>residuals &lt;-<span class="st"> </span><span class="kw">residuals</span>(M3)</a>
<a class="sourceLine" id="cb25-2" title="2"><span class="kw">ggplot</span>(df.log, <span class="kw">aes</span>(<span class="dt">x =</span> area, <span class="dt">y =</span> residuals)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb25-3" title="3"><span class="st">               </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">span =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb25-4" title="4">                           <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">degree =</span> <span class="dv">1</span>) )</a></code></pre></div>
<p><img src="Week09a_files/figure-html/unnamed-chunk-24-1.png" width="240" /></p>
<p>Logging the y values has eliminated the residual’s dependence on <code>area</code>. Next, let’s assess homogeneity in the residuals using the s-l plot.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">sl3 &lt;-<span class="st"> </span><span class="kw">data.frame</span>( <span class="dt">std.res =</span> <span class="kw">sqrt</span>(<span class="kw">abs</span>(<span class="kw">residuals</span>(M3))), </a>
<a class="sourceLine" id="cb26-2" title="2">                   <span class="dt">fit     =</span> <span class="kw">predict</span>(M3))</a>
<a class="sourceLine" id="cb26-3" title="3"><span class="kw">ggplot</span>(sl3, <span class="kw">aes</span>(<span class="dt">x =</span> fit, <span class="dt">y =</span> std.res)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb26-4" title="4"><span class="st">               </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span><span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">span =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb26-5" title="5">                           <span class="dt">method.args=</span><span class="kw">list</span>(<span class="dt">degree =</span> <span class="dv">1</span>) )</a></code></pre></div>
<p><img src="Week09a_files/figure-html/unnamed-chunk-25-1.png" width="240" /></p>
<p>We do not observe a systematic increase in spread, the log transformation seems to have removed the monotone spread.</p>
<p>Finally, we’ll check for normality of the residuals.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">ggplot</span>(df.log, <span class="kw">aes</span>(<span class="dt">sample =</span> residuals)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_qq</span>(<span class="dt">distribution =</span> qnorm) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="st">  </span><span class="kw">geom_qq_line</span>(<span class="dt">distribution =</span> qnorm, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<p><img src="Week09a_files/figure-html/unnamed-chunk-26-1.png" width="240" /></p>
<p>An added benefit of re-expressing the data seems to be a slight improvement in the normality of the residuals.</p>
</div>


<div class="footer">
<hr/>
<a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/80x15.png" /></a>  Manny Gimond (2020)
</br>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
