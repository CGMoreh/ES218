<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>A working example: Cleaning a buoy data table</title>

<script src="site_libs/header-attrs-2.6/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-39623718-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-39623718-2');
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


<link rel="stylesheet" href="libs/style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fas fa-home"></span>
     
    
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Introduction
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Week01.html">Course Introduction</a>
    </li>
    <li>
      <a href="R_vs_RStudio.html">R vs RStudio</a>
    </li>
    <li>
      <a href="The_R_environment.html">The R/RStudio environments</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data Manipulation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 02</li>
    <li>
      <a href="Week02a.html">Data types</a>
    </li>
    <li>
      <a href="Week02b.html">Reading and writing data files</a>
    </li>
    <li>
      <a href="Week02c.html">Working with date objects</a>
    </li>
    <li>
      <a href="Week02_pre_d.html">Extracting and replacing values using base functions</a>
    </li>
    <li>
      <a href="Week02_pre_d2.html">Relational and boolean operations</a>
    </li>
    <li>
      <a href="Week02d.html">Example: Cleaning a buoy data table</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 03</li>
    <li>
      <a href="Week03a.html">Manipulating dataframes with dplyr</a>
    </li>
    <li>
      <a href="Week03d.html">Working with string objects</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 04</li>
    <li>
      <a href="Week03ab_groupby.html">Grouping and summarizing tables</a>
    </li>
    <li>
      <a href="Week03b.html">Tidying/reshaping tables using tidyr</a>
    </li>
    <li>
      <a href="Week03c.html">Joining data tables</a>
    </li>
    <li>
      <a href="Week03ab_examples.html">Example of data manipulation workflows</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Plots
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 05</li>
    <li>
      <a href="Week04a.html">The base plotting environment</a>
    </li>
    <li>
      <a href="Week04b.html">The lattice plotting environment</a>
    </li>
    <li>
      <a href="Week04c.html">The ggplot plotting environment</a>
    </li>
    <li>
      <a href="Week04d.html">Manipulating colors in R</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Univariate
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 06</li>
    <li>
      <a href="Week05a.html">Visualizing univariate data</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 07</li>
    <li>
      <a href="Week05b.html">Comparing univariate data distributions</a>
    </li>
    <li>
      <a href="Week06a.html">Theoretical Q-Q plot</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 08</li>
    <li>
      <a href="Week07a.html">Fits and residuals</a>
    </li>
    <li>
      <a href="Week07b.html">Spread-location plot</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 09</li>
    <li>
      <a href="Week08a.html">Re-expressing data</a>
    </li>
    <li>
      <a href="Week08b.html">Letter value summaries</a>
    </li>
    <li>
      <a href="Week08c.html">The Two R’s of EDA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Bivariate
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 10</li>
    <li>
      <a href="Week09a.html">Bivariate analysis</a>
    </li>
    <li>
      <a href="Week09b.html">Resistant lines</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Week 11</li>
    <li>
      <a href="Week10a.html">The third R of EDA: Residuals</a>
    </li>
    <li>
      <a href="Week10b.html">Detecting discontinuities in the data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Two-way tables
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Week 12</li>
    <li>
      <a href="Week11a.html">Median polish/Mean polish</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Misc
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Misc01.html">R markdown documents</a>
    </li>
    <li class="dropdown-header">Week 13</li>
    <li>
      <a href="Week12a.html">Creating maps in R</a>
    </li>
    <li class="dropdown-header">Connecting to relational databases</li>
  </ul>
</li>
<li>
  <a href="Data.html">Datasets</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<link href="https://fonts.googleapis.com/css?family=Open+Sans%7CSource+Code+Pro" rel="stylesheet">

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">A working example: Cleaning a buoy data table</h1>

</div>


<p>The dataset used in this tutorial was downloaded from <a href="http://www.ndbc.noaa.gov/view_text_file.php?filename=44005h2010.txt.gz&amp;dir=data/historical/stdmet/">NOAA’ NDBC buoy data center</a> in a space delimited file format. It consists of hourly air and ocean physical measurements such as temperature, wind speed and wave height for 2012 measured at NOAA’s buoy #44005 located in the Gulf of Maine (43.204 N, 69.128 W).</p>
<p>Type the following to load the data file into your current R session (note that we are using the <code>read.table</code> function instead of the <code>read.csv</code> function since the data are not comma delimited):</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;http://mgimond.github.io/ES218/Data/buoy_44005_2012.dat&quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>Since <code>read.table</code> defaults to a space separated format (the same format our data file is stored in), there is no need to specify the <code>sep=</code> parameter.</p>
<div id="exploring-a-dataframe" class="section level1">
<h1>Exploring a dataframe</h1>
<p>First, let’s extract the number of rows and columns in our table:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(dat)</span></code></pre></div>
<pre><code>[1] 8347   18</code></pre>
<p><code>dat</code> consists of 8347 rows and 18 columns.</p>
<p>We can extract the names of each column using the <code>names</code> function:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dat)</span></code></pre></div>
<pre><code> [1] &quot;YY&quot;   &quot;MM&quot;   &quot;DD&quot;   &quot;hh&quot;   &quot;mm&quot;   &quot;WDIR&quot; &quot;WSPD&quot; &quot;GST&quot;  &quot;WVHT&quot; &quot;DPD&quot; 
[11] &quot;APD&quot;  &quot;MWD&quot;  &quot;PRES&quot; &quot;ATMP&quot; &quot;WTMP&quot; &quot;DEWP&quot; &quot;VIS&quot;  &quot;TIDE&quot;</code></pre>
<p>A brief description of each column follows:</p>
<table>
<colgroup>
<col width="20%" />
<col width="79%" />
</colgroup>
<thead>
<tr class="header">
<th>Field</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>YY</td>
<td>Year</td>
</tr>
<tr class="even">
<td>MM</td>
<td>Month</td>
</tr>
<tr class="odd">
<td>DD</td>
<td>Day</td>
</tr>
<tr class="even">
<td>hh</td>
<td>Hour</td>
</tr>
<tr class="odd">
<td>mm</td>
<td>Minute</td>
</tr>
<tr class="even">
<td>WDIR</td>
<td>Wind direction (the direction the wind is coming from in degrees clockwise from true N)</td>
</tr>
<tr class="odd">
<td>WSPD</td>
<td>Wind speed, averaged over an eight-minute period (m/s)</td>
</tr>
<tr class="even">
<td>GST</td>
<td>Peak 5 or 8 second gust speed measured during the eight-minute or two-minute period(m/s)</td>
</tr>
<tr class="odd">
<td>WVHT</td>
<td>Significant wave height (meters)</td>
</tr>
<tr class="even">
<td>DPD</td>
<td>Dominant wave period (seconds)</td>
</tr>
<tr class="odd">
<td>APD</td>
<td>Average wave period (seconds)</td>
</tr>
<tr class="even">
<td>MWD</td>
<td>The direction from which the waves at the dominant period (DPD) are coming. The units are degrees from true North, increasing clockwise, with North as 0 (zero) degrees and East as 90 degrees.</td>
</tr>
<tr class="odd">
<td>PRES</td>
<td>Sea level pressure (hPa)</td>
</tr>
<tr class="even">
<td>ATMP</td>
<td>Air temperature (Celsius)</td>
</tr>
<tr class="odd">
<td>WTMP</td>
<td>Sea surface temperature (Celsius)</td>
</tr>
<tr class="even">
<td>DEWP</td>
<td>Dewpoint temperature (Celsius)</td>
</tr>
<tr class="odd">
<td>VIS</td>
<td>visibility (nautical miles)</td>
</tr>
<tr class="even">
<td>TIDE</td>
<td>Water level in feet above or below Mean Lower Low Water, MLLW (feet)</td>
</tr>
</tbody>
</table>
<p>For large datasets, it’s sometimes helpful to display just the first few lines of the table to get a sense of the kind of data we are dealing with. We’ll use the <code>head</code> function to do this and have R return the first five records of the table (<code>n=5</code>).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>( dat, <span class="at">n=</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>    YY MM DD hh mm WDIR WSPD  GST WVHT  DPD  APD MWD   PRES ATMP WTMP DEWP VIS
1 2011 12 31 23 50  316  4.8  6.0 0.92 5.56 4.88 999 1008.1  6.8  8.1  6.8  99
2 2012  1  1  0 50  296  5.5  6.3 0.89 5.56 4.60 999 1007.8  6.1  8.1  6.1  99
3 2012  1  1  1 50  311  8.4 10.0 0.87 8.33 4.09 999 1008.2  5.5  8.1  5.5  99
4 2012  1  1  2 50  314  8.3 10.0 0.93 3.45 4.05 999 1008.0  5.4  8.1  5.4  99
5 2012  1  1  3 50  313 11.1 13.0 1.12 3.85 3.88 999 1008.0  5.8  8.1  5.8  99
  TIDE
1   99
2   99
3   99
4   99
5   99</code></pre>
<p>We can also display the last few lines of the table using the <code>tail</code> function.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>( dat, <span class="at">n =</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>       YY MM DD hh mm WDIR WSPD GST WVHT   DPD  APD MWD   PRES ATMP WTMP DEWP
8343 2012 12 14  1 50  999   99  99 0.31  9.09 5.15 999 1026.3  5.6  9.7 -4.1
8344 2012 12 14  2 50  999   99  99 0.33  9.09 4.69 999 1025.5  5.6  9.7 -4.2
8345 2012 12 14  3 50  999   99  99 0.36 12.90 4.04 999 1025.0  5.6  9.7 -4.2
8346 2012 12 14  4 50  999   99  99 0.36 12.90 3.87 999 1024.6  5.6  9.7 -4.0
8347 2012 12 14  5 50  999   99  99 0.37  8.33 3.66 999 1023.8  5.6  9.6 -3.9
     VIS TIDE
8343  99   99
8344  99   99
8345  99   99
8346  99   99
8347  99   99</code></pre>
<p>To view the data type/class associated with each variable in the table, we’ll use the <code>str</code> function.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dat)</span></code></pre></div>
<pre><code>&#39;data.frame&#39;:   8347 obs. of  18 variables:
 $ YY  : int  2011 2012 2012 2012 2012 2012 2012 2012 2012 2012 ...
 $ MM  : int  12 1 1 1 1 1 1 1 1 1 ...
 $ DD  : int  31 1 1 1 1 1 1 1 1 1 ...
 $ hh  : int  23 0 1 2 3 4 5 6 7 8 ...
 $ mm  : int  50 50 50 50 50 50 50 50 50 50 ...
 $ WDIR: int  316 296 311 314 313 319 319 318 332 322 ...
 $ WSPD: num  4.8 5.5 8.4 8.3 11.1 11.1 11.1 10.5 9.8 8.2 ...
 $ GST : num  6 6.3 10 10 13 13.3 13.2 12.5 11.5 9.6 ...
 $ WVHT: num  0.92 0.89 0.87 0.93 1.12 1.25 1.48 1.46 1.41 1.23 ...
 $ DPD : num  5.56 5.56 8.33 3.45 3.85 4.76 4.55 5 5 5 ...
 $ APD : num  4.88 4.6 4.09 4.05 3.88 4.06 4.31 4.39 4.31 4.15 ...
 $ MWD : int  999 999 999 999 999 999 999 999 999 999 ...
 $ PRES: num  1008 1008 1008 1008 1008 ...
 $ ATMP: num  6.8 6.1 5.5 5.4 5.8 5.8 6 6.5 6.8 6.7 ...
 $ WTMP: num  8.1 8.1 8.1 8.1 8.1 8 8 8.1 8.1 8.1 ...
 $ DEWP: num  6.8 6.1 5.5 5.4 5.8 5.7 5.8 5.5 5.1 5.2 ...
 $ VIS : num  99 99 99 99 99 99 99 99 99 99 ...
 $ TIDE: num  99 99 99 99 99 99 99 99 99 99 ...</code></pre>
<p>All values are stored as numbers with about a third of those stored as integers, <code>int</code>, and the others as double precision, <code>num</code>.</p>
<p>Now let’s generate a descriptive summary of the table.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dat)</span></code></pre></div>
<pre><code>       YY             MM               DD             hh              mm    
 Min.   :2011   Min.   : 1.000   Min.   : 1.0   Min.   : 0.00   Min.   :50  
 1st Qu.:2012   1st Qu.: 3.000   1st Qu.: 8.0   1st Qu.: 5.00   1st Qu.:50  
 Median :2012   Median : 6.000   Median :15.0   Median :11.00   Median :50  
 Mean   :2012   Mean   : 6.234   Mean   :15.4   Mean   :11.49   Mean   :50  
 3rd Qu.:2012   3rd Qu.: 9.000   3rd Qu.:23.0   3rd Qu.:17.50   3rd Qu.:50  
 Max.   :2012   Max.   :12.000   Max.   :31.0   Max.   :23.00   Max.   :50  
      WDIR            WSPD           GST             WVHT       
 Min.   :  1.0   Min.   : 0.0   Min.   : 0.00   Min.   : 0.260  
 1st Qu.:143.0   1st Qu.: 3.9   1st Qu.: 4.80   1st Qu.: 0.740  
 Median :213.0   Median : 6.2   Median : 7.40   Median : 1.070  
 Mean   :234.3   Mean   :10.5   Mean   :11.81   Mean   : 1.624  
 3rd Qu.:285.0   3rd Qu.: 8.9   3rd Qu.:10.70   3rd Qu.: 1.580  
 Max.   :999.0   Max.   :99.0   Max.   :99.00   Max.   :99.000  
      DPD              APD              MWD           PRES       
 Min.   : 2.600   Min.   : 3.120   Min.   :999   Min.   : 981.3  
 1st Qu.: 5.560   1st Qu.: 4.410   1st Qu.:999   1st Qu.:1009.2  
 Median : 7.140   Median : 5.000   Median :999   Median :1014.9  
 Mean   : 7.982   Mean   : 5.551   Mean   :999   Mean   :1017.9  
 3rd Qu.: 9.090   3rd Qu.: 5.830   3rd Qu.:999   3rd Qu.:1020.5  
 Max.   :99.000   Max.   :99.000   Max.   :999   Max.   :9999.0  
      ATMP             WTMP            DEWP              VIS          TIDE   
 Min.   :-11.00   Min.   : 5.40   Min.   :-16.000   Min.   :99   Min.   :99  
 1st Qu.:  5.60   1st Qu.: 7.10   1st Qu.:  0.900   1st Qu.:99   1st Qu.:99  
 Median : 10.40   Median :11.60   Median :  8.600   Median :99   Median :99  
 Mean   : 10.78   Mean   :12.17   Mean   :  8.268   Mean   :99   Mean   :99  
 3rd Qu.: 16.80   3rd Qu.:16.30   3rd Qu.: 15.300   3rd Qu.:99   3rd Qu.:99  
 Max.   : 25.10   Max.   :24.30   Max.   :999.000   Max.   :99   Max.   :99  </code></pre>
<p>You’ll note that many columns in our data contain values of 99 or 999. Such values are often placeholders for missing data. If not dealt with properly, these values may be interpreted as valid data in subsequent analyses. One tell-tale sign that these values should be treated specially is their extreme values compared to the rest of the data batch. For example, the wave height field, <code>WVHT</code>, has values that average less than 2 meters so a value of 99 meters should be flagged as suspicious. In fact, NOAA’s <a href="http://www.ndbc.noaa.gov/measdes.shtml">documentation</a> states that <em>“Missing data … are denoted by … a variable number of 9’s … depending on the data type (for example: 999.0 99.0).”</em></p>
<p>We also note that some columns have nothing but missing values (e.g. <code>VIS</code> and <code>TIDE</code>) suggesting that either these variables are not measured at this particular buoy or the instruments did not function properly during the data collection period.</p>
<p>Before proceeding with any analysis, we need to address the missing values by flagging them as such or removing them all together.</p>
</div>
<div id="removing-columns-with-no-data" class="section level1">
<h1>Removing columns with no data</h1>
<p>Let’s first remove all columns devoid of valid data. These columns are <code>MWD</code>, <code>VIS</code> and <code>TIDE</code>. There are many ways to do this. We will opt for subsetting the table and assigning this subset to a new data frame we will call <code>dat1</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">&lt;-</span> dat[ , <span class="sc">!</span>(<span class="fu">names</span>(dat) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;MWD&quot;</span>, <span class="st">&quot;VIS&quot;</span>, <span class="st">&quot;TIDE&quot;</span>))]</span></code></pre></div>
<p>Let’s break down this expression into its many components. <code>names(dat)</code> returns a list of column names in the order in which they appear in the object <code>dat</code>: YY, MM, DD, hh, mm, WDIR, WSPD, GST, WVHT, DPD, APD, MWD, PRES, ATMP, WTMP, DEWP, VIS, TIDE.</p>
<p>The matching operator <code>%in%</code> compares two sets of vectors and assesses if an element on the left-hand side of <code>%in%</code> is included in the elements on the right. For each element in the left hand set, R returns <code>TRUE</code> if the value is present in the right-hand set of values or <code>FALSE</code> if it is not. In our example, R is evaluating if the column names are included in the set of elements defined in <code>c("MWD", "VIS", "TIDE")</code>. The expression could be read as “… are any of the column names (i.e. YY, MM, DD, hh, mm, WDIR, WSPD, GST, WVHT, DPD, APD, MWD, PRES, ATMP, WTMP, DEWP, VIS, TIDE) included in the set <code>("MWD", "VIS", "TIDE")</code>?” The output of this comparison is a series of <code>TRUE</code>’s and <code>FALSE</code>’s depending on whether or not a match is found.</p>
<center>
<video width="620"  controls  style="float:center;">
<source src="./Videos/Matching_operator.mp4" type="video/mp4">
</video>
</center>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dat) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;MWD&quot;</span>, <span class="st">&quot;VIS&quot;</span>, <span class="st">&quot;TIDE&quot;</span>)</span></code></pre></div>
<pre><code> [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE
[13] FALSE FALSE FALSE FALSE  TRUE  TRUE</code></pre>
<p>The order in which the <code>TRUE</code>’s and <code>FALSE</code>’s are listed match the order of the column names. This order is important because this index is what R uses to identify which columns to return. But wait, R will return columns associated with a <code>TRUE</code> value! We want the reverse, so we add the NOT operator, <code>!</code>, in front of the expression thus flipping the <code>TRUE</code>/<code>FALSE</code> values.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span>(<span class="fu">names</span>(dat) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;MWD&quot;</span>, <span class="st">&quot;VIS&quot;</span>, <span class="st">&quot;TIDE&quot;</span>))</span></code></pre></div>
<pre><code> [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE
[13]  TRUE  TRUE  TRUE  TRUE FALSE FALSE</code></pre>
<p>So <code>dat1</code> contains all the columns except <code>MWD</code>, <code>VIS</code> and <code>TIDE</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat1)</span></code></pre></div>
<pre><code>    YY MM DD hh mm WDIR WSPD  GST WVHT  DPD  APD   PRES ATMP WTMP DEWP
1 2011 12 31 23 50  316  4.8  6.0 0.92 5.56 4.88 1008.1  6.8  8.1  6.8
2 2012  1  1  0 50  296  5.5  6.3 0.89 5.56 4.60 1007.8  6.1  8.1  6.1
3 2012  1  1  1 50  311  8.4 10.0 0.87 8.33 4.09 1008.2  5.5  8.1  5.5
4 2012  1  1  2 50  314  8.3 10.0 0.93 3.45 4.05 1008.0  5.4  8.1  5.4
5 2012  1  1  3 50  313 11.1 13.0 1.12 3.85 3.88 1008.0  5.8  8.1  5.8
6 2012  1  1  4 50  319 11.1 13.3 1.25 4.76 4.06 1008.8  5.8  8.0  5.7</code></pre>
</div>
<div id="assigning-na-to-missing-data" class="section level1">
<h1>Assigning <code>NA</code> to missing data</h1>
<center>
<video width="560"  controls  style="float:center;">
<source src="./Videos/Replace_99_with_NA.mp4" type="video/mp4">
</video>
</center>
<p>It’s usually best to assign <code>NA</code> values the moment a data file is loaded into R. For example, had all <code>NA</code> values been flagged as <code>-9999</code>, we could have added the parameter <code>na.strings="-9999"</code> to the <code>read.table()</code> function. But our dataset contains missing values flagged as 99, 999 <em>and</em> 9999 requiring that we combine the missing string values such as <code>na.strings = c("99", "999", "9999")</code> however, this would have resulted in undesirable outcomes. For example, a wave height of 99 meters would clearly not make sense, so flagging such value as <code>NA</code> would be sensible, but a wind direction of 99 degrees would make sense and flagging such value as <code>NA</code> would not be appropriate. Had we set <em>all</em> values of 99 to <code>NA</code> the moment we loaded the file into R, we would have inadvertently removed valid values in the dataset. So flagging missing values as <code>NA</code> in our dataset will require column level intervention.</p>
<p>Let’s review the data summary to identify each column’s no data numeric designation (i.e. 99 or 999 or 9999) if present. Remember that we are now working off of the <code>dat1</code> dataframe and not the original <code>dat</code> dataframe.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dat1)</span></code></pre></div>
<pre><code>       YY             MM               DD             hh              mm    
 Min.   :2011   Min.   : 1.000   Min.   : 1.0   Min.   : 0.00   Min.   :50  
 1st Qu.:2012   1st Qu.: 3.000   1st Qu.: 8.0   1st Qu.: 5.00   1st Qu.:50  
 Median :2012   Median : 6.000   Median :15.0   Median :11.00   Median :50  
 Mean   :2012   Mean   : 6.234   Mean   :15.4   Mean   :11.49   Mean   :50  
 3rd Qu.:2012   3rd Qu.: 9.000   3rd Qu.:23.0   3rd Qu.:17.50   3rd Qu.:50  
 Max.   :2012   Max.   :12.000   Max.   :31.0   Max.   :23.00   Max.   :50  
      WDIR            WSPD           GST             WVHT       
 Min.   :  1.0   Min.   : 0.0   Min.   : 0.00   Min.   : 0.260  
 1st Qu.:143.0   1st Qu.: 3.9   1st Qu.: 4.80   1st Qu.: 0.740  
 Median :213.0   Median : 6.2   Median : 7.40   Median : 1.070  
 Mean   :234.3   Mean   :10.5   Mean   :11.81   Mean   : 1.624  
 3rd Qu.:285.0   3rd Qu.: 8.9   3rd Qu.:10.70   3rd Qu.: 1.580  
 Max.   :999.0   Max.   :99.0   Max.   :99.00   Max.   :99.000  
      DPD              APD              PRES             ATMP       
 Min.   : 2.600   Min.   : 3.120   Min.   : 981.3   Min.   :-11.00  
 1st Qu.: 5.560   1st Qu.: 4.410   1st Qu.:1009.2   1st Qu.:  5.60  
 Median : 7.140   Median : 5.000   Median :1014.9   Median : 10.40  
 Mean   : 7.982   Mean   : 5.551   Mean   :1017.9   Mean   : 10.78  
 3rd Qu.: 9.090   3rd Qu.: 5.830   3rd Qu.:1020.5   3rd Qu.: 16.80  
 Max.   :99.000   Max.   :99.000   Max.   :9999.0   Max.   : 25.10  
      WTMP            DEWP        
 Min.   : 5.40   Min.   :-16.000  
 1st Qu.: 7.10   1st Qu.:  0.900  
 Median :11.60   Median :  8.600  
 Mean   :12.17   Mean   :  8.268  
 3rd Qu.:16.30   3rd Qu.: 15.300  
 Max.   :24.30   Max.   :999.000  </code></pre>
<p>It appears that the fields with missing values flagged as <code>99</code> are <code>WSPD</code>, <code>GST</code>, <code>WVHT</code>, <code>DPD</code> and <code>APD</code>; fields with missing values flagged as <code>999</code> are <code>WDIR</code> and <code>DEWP</code>; and the field with missing values flagged as <code>9999</code> is <code>PRES</code>. We will convert these values to missing values in the following chunk of code.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create list of columns with missing values</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>na99   <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;WSPD&quot;</span>, <span class="st">&quot;GST&quot;</span>, <span class="st">&quot;WVHT&quot;</span>, <span class="st">&quot;DPD&quot;</span>,  <span class="st">&quot;APD&quot;</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>na999  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;WDIR&quot;</span>,  <span class="st">&quot;DEWP&quot;</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>na9999 <span class="ot">&lt;-</span> (<span class="st">&quot;PRES&quot;</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace missing values with NA</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>dat1[ ,na99][dat1[ ,na99] <span class="sc">==</span> <span class="dv">99</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>dat1[ ,na999][dat1[ ,na999] <span class="sc">==</span> <span class="dv">999</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>dat1[ ,na9999][dat1[ ,na9999] <span class="sc">==</span> <span class="dv">9999</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
<p>The above expression is quite succinct, but succinctness does not always translate to easy readability. There are two components to the last three lines of code: The first is a subset of columns for which a particular missing value is designated (e.g. <code>dat1[,na99]</code> ), the second is an evaluation statement identifying which values in the column subset is flagged as missing (e.g. <code>[dat1[, na99] == 99]</code>). Together, these elements define the indices (table cells) for which a value is replaced with <code>NA</code> (e.g. <code>&lt;- NA</code>).</p>
<p>Another way this could have been accomplished (and one you might feel more comfortable with) would have been to work off of one column at a time, for example:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>dat1<span class="sc">$</span>WSPD[dat1<span class="sc">$</span>WSPD <span class="sc">==</span> <span class="dv">99</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>dat1<span class="sc">$</span>GST[dat1<span class="sc">$</span>GST   <span class="sc">==</span> <span class="dv">99</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>dat1<span class="sc">$</span>WVHT[dat1<span class="sc">$</span>WVHT <span class="sc">==</span> <span class="dv">99</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>dat1<span class="sc">$</span>DPD[dat1<span class="sc">$</span>DPD   <span class="sc">==</span> <span class="dv">99</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>dat1<span class="sc">$</span>APD[dat1<span class="sc">$</span>APD   <span class="sc">==</span> <span class="dv">99</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>dat1<span class="sc">$</span>WDIR[dat1<span class="sc">$</span>WDIR <span class="sc">==</span> <span class="dv">999</span>]  <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>dat1<span class="sc">$</span>DEWP[dat1<span class="sc">$</span>DEWP <span class="sc">==</span> <span class="dv">999</span>]  <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>dat1<span class="sc">$</span>PRES[dat1<span class="sc">$</span>PRES <span class="sc">==</span> <span class="dv">9999</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span></code></pre></div>
<p>This chunk of code is easier to read, but lacks the succinctness of its predecessor.</p>
<p>Let’s look at a summary of our table:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dat1)</span></code></pre></div>
<pre><code>       YY             MM               DD             hh              mm    
 Min.   :2011   Min.   : 1.000   Min.   : 1.0   Min.   : 0.00   Min.   :50  
 1st Qu.:2012   1st Qu.: 3.000   1st Qu.: 8.0   1st Qu.: 5.00   1st Qu.:50  
 Median :2012   Median : 6.000   Median :15.0   Median :11.00   Median :50  
 Mean   :2012   Mean   : 6.234   Mean   :15.4   Mean   :11.49   Mean   :50  
 3rd Qu.:2012   3rd Qu.: 9.000   3rd Qu.:23.0   3rd Qu.:17.50   3rd Qu.:50  
 Max.   :2012   Max.   :12.000   Max.   :31.0   Max.   :23.00   Max.   :50  
                                                                            
      WDIR            WSPD             GST              WVHT      
 Min.   :  1.0   Min.   : 0.000   Min.   : 0.000   Min.   :0.260  
 1st Qu.:136.0   1st Qu.: 3.800   1st Qu.: 4.700   1st Qu.:0.740  
 Median :208.0   Median : 6.000   Median : 7.200   Median :1.060  
 Mean   :198.2   Mean   : 6.315   Mean   : 7.684   Mean   :1.285  
 3rd Qu.:273.0   3rd Qu.: 8.500   3rd Qu.:10.200   3rd Qu.:1.570  
 Max.   :360.0   Max.   :18.800   Max.   :23.300   Max.   :8.650  
 NA&#39;s   :377     NA&#39;s   :377      NA&#39;s   :377      NA&#39;s   :29     
      DPD              APD              PRES             ATMP       
 Min.   : 2.600   Min.   : 3.120   Min.   : 981.3   Min.   :-11.00  
 1st Qu.: 5.560   1st Qu.: 4.410   1st Qu.:1009.2   1st Qu.:  5.60  
 Median : 7.140   Median : 5.000   Median :1014.9   Median : 10.40  
 Mean   : 7.664   Mean   : 5.225   Mean   :1014.6   Mean   : 10.78  
 3rd Qu.: 9.090   3rd Qu.: 5.820   3rd Qu.:1020.5   3rd Qu.: 16.80  
 Max.   :17.390   Max.   :10.430   Max.   :1040.2   Max.   : 25.10  
 NA&#39;s   :29       NA&#39;s   :29       NA&#39;s   :3                        
      WTMP            DEWP        
 Min.   : 5.40   Min.   :-16.000  
 1st Qu.: 7.10   1st Qu.:  0.900  
 Median :11.60   Median :  8.600  
 Mean   :12.17   Mean   :  7.793  
 3rd Qu.:16.30   3rd Qu.: 15.300  
 Max.   :24.30   Max.   : 23.900  
                 NA&#39;s   :4        </code></pre>
<p>Note the <code>NA</code>’s in the summary output. We now have a clean dataframe to work with.</p>
</div>
<div id="removing-rows-with-na-values" class="section level1">
<h1>Removing rows with <code>NA</code> values</h1>
<p>Your analysis might require that all rows in a table have complete cases (i.e. no missing values). You can use the <code>na.omit</code> function to return just the rows that have complete cases. We will create a synthetic example to demonstrate the <code>na.omit()</code> function.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="cn">NA</span>), </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">8</span>,<span class="dv">1</span>,<span class="dv">1</span>), </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">z =</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="dv">4</span>,<span class="dv">9</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">3</span>))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code>   x y  z
1  1 3 NA
2  4 2 NA
3  2 5  4
4  5 3  9
5  2 8  7
6  3 1  8
7 NA 1  3</code></pre>
<p>Note the <code>NA</code> values in the dataframe. Now let’s create a new dataframe that we’ll name <code>d.complete</code> that only stores the rows for which we have complete cases (i.e. no <code>NA</code> values).</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>d.complete <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(d)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>d.complete</span></code></pre></div>
<pre><code>  x y z
3 2 5 4
4 5 3 9
5 2 8 7
6 3 1 8</code></pre>
<p>All rows with at least one <code>NA</code> value have been removed. Note that the table’s dimension has changed from seven rows to four.</p>
</div>
<div id="checking-if-a-value-is-na" class="section level1">
<h1>Checking if a value is <code>NA</code></h1>
<p>When assessing if a value is equal to <code>NA</code> the following evaluation may behave unexpectedly.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span> (<span class="dv">3</span>, <span class="dv">67</span>, <span class="dv">4</span>, <span class="cn">NA</span>, <span class="dv">10</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>a <span class="sc">==</span> <span class="cn">NA</span></span></code></pre></div>
<pre><code>[1] NA NA NA NA NA</code></pre>
<p>The output is not a logical data type we would expect from an evaluation. Instead, you must make use of the <code>is.na()</code> function:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.na</span>(a)</span></code></pre></div>
<pre><code>[1] FALSE FALSE FALSE  TRUE FALSE</code></pre>
<p>As another example, if we want to keep all rows in dataframe <code>d</code> where <code>z</code> = <code>NA</code>, we would type:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>d[ <span class="fu">is.na</span>(d<span class="sc">$</span>z), ]</span></code></pre></div>
<pre><code>  x y  z
1 1 3 NA
2 4 2 NA</code></pre>
<p>You can, of course, use the <code>!</code> operator to reverse the evaluation and <em>omit</em> all rows where <code>z</code> = <code>NA</code>,</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>d[ <span class="sc">!</span><span class="fu">is.na</span>(d<span class="sc">$</span>z), ]</span></code></pre></div>
<pre><code>   x y z
3  2 5 4
4  5 3 9
5  2 8 7
6  3 1 8
7 NA 1 3</code></pre>
</div>
<div id="is-there-an-easier-way" class="section level1">
<h1>Is there an easier way?</h1>
<p>Cleaning data tables is an important component of any analytical workflow, but the syntax used thus far can get complicated and be difficult to follow. Fortunately, there is an easier way to clean data tables using the <code>dplyr</code> package which will be covered in <a href="Week03a.html">Week 3</a>.</p>
</div>


<div class="footer">
<hr/>
<a rel="license" href="https://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/80x15.png" /></a>  Manny Gimond (2021)
</br>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
